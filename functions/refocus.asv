function [Tout, Phout] = refocus(T, Ph, z, pxSize, lambda, opt)
% numerical propagation over the distance z
arguments
    IM
    z      {mustBeNumeric}
    pxSize
    lambda
    opt.n  {mustBeNumeric} = 1 % refractive index of the propagation medium
end

image = sqrt(T).*exp(1i*Ph);
[~, Pha, Int]=imProp(image,pxSize,lambda,z,'n',n);
[~, Pha0]=imProp(image*0+1,pxSize,lambda,z,'n',n);

IMout(io).T0 = Int;
IMout(io).OPD0 = (Pha-Pha0)*IM(io).Illumination.lambda/(2*pi);
end

